<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!--During development turn off caching-->
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <title></title>
    <!--<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>-->
    <script src="https://appsforoffice.microsoft.com/lib/beta/hosted/office.js" type="text/javascript"></script>
   
    <script src=" https//ajax.googleapis.com/ajax/libs/angularjs/1.6.1/angular.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <script>


        (function () {

            Office.initialize = function (reason) {
                //If you need to initialize something you can do so here.


            };
        })();




        //var DeploymentHost = "https://realdocs.pronetcre.com/";
        var DeploymentHost = "https://localhost:44380/";
        var DialogOpened = "false";//localStorage.getItem("DialogOpened");
        var MyAgreementsDialog;
        var CompanyAgreementsDialog;
        var RealDocsDialog;      
        var MyAgreementsDialogUrl = DeploymentHost + "MyAgreementsDialog.html"
        var CompanyAgreementsDialogUrl = DeploymentHost + "CompanyAgreementsDialog.html"
        var RealDocsDialogUrl = DeploymentHost + "RealDocsDialog.html"


        
       

        function DialogClosed() { localStorage.setItem("DialogOpened", false); }


        // Show dialogs Functions
        function ShowMyAgreementsDialog() {
            if (DialogOpened == "false"  || DialogOpened === null) {
                Office.context.ui.displayDialogAsync(MyAgreementsDialogUrl, { height: 60, width: 25, displayInIframe: false },
                    function (asyncResult) {
                        MyAgreementsDialog = asyncResult.value;
                        MyAgreementsDialog.addEventHandler(Office.EventType.DialogMessageReceived, processMyAgreementsDialogMessage);
                        MyAgreementsDialog.addEventHandler(Office.EventType.DialogEventReceived, DialogClosed);


                    }
                );
                localStorage.setItem("DialogOpened", true);
            }


        }
        function ShowRealDocsDialog() {
            if (DialogOpened == "false" || DialogOpened === null) {
                Office.context.ui.displayDialogAsync(RealDocsDialogUrl, { height: 60, width: 25, displayInIframe: false },
                    function (asyncResult) {
                        RealDocsDialog = asyncResult.value;
                        RealDocsDialog.addEventHandler(Office.EventType.DialogMessageReceived, processRealDocsDialogMessage);
                        RealDocsDialog.addEventHandler(Office.EventType.DialogEventReceived, RealDocsDialogClosed);


                    }
                );
                localStorage.setItem("DialogOpened", true);
            }


        }
        function ShowCompanyAgreementsDialog() {
            if (DialogOpened == "false" || DialogOpened === null) {
                Office.context.ui.displayDialogAsync(CompanyAgreementsDialogUrl, { height: 60, width: 25, displayInIframe: false },
                    function (asyncResult) {
                        CompanyAgreementsDialog = asyncResult.value;
                        CompanyAgreementsDialog.addEventHandler(Office.EventType.DialogMessageReceived, processComapnyAgreementsDialogMessage);
                        CompanyAgreementsDialog.addEventHandler(Office.EventType.DialogEventReceived, CompanyAgreementsDialogClosed);


                    }
                );
                localStorage.setItem("DialogOpened", true);
            }


        }




        function processMyAgreementsDialogMessage(arg) {
            MyAgreementsDialog.close();
            if (arg.message == "True") {

            }
            else {
                var MessageObj = JSON.parse(arg.message);
                Insertdocument(MessageObj.data, MessageObj.LibraryIDs);
             
            }
           
            localStorage.setItem("DialogOpened", false);
        }
        function processComapnyAgreementsDialogMessage(arg) {
            CompanyAgreementsDialog.close();
            if (arg.message == "True") {

            }
            else {
                var MessageObj = JSON.parse(arg.message);
                Insertdocument(MessageObj.data, MessageObj.LibraryIDs);
            }
           
            localStorage.setItem("DialogOpened", false);
        } 
        function processRealDocsDialogMessage(arg) {
            RealDocsDialog.close();
            if (arg.message == "True") {

            }
            else {
                var MessageObj = JSON.parse(arg.message);
                Insertdocument(MessageObj.data, null);
                //$scope.Refresh();
            }
         
            localStorage.setItem("DialogOpened", false);
        }

        function Insertdocument(doc, DocsAssociatedLibraries) {


            Word.run(function (context) {

                var myNewDoc = context.application.createDocument(doc);
                myNewDoc.properties.comments = JSON.stringify(DocsAssociatedLibraries);
                context.load(myNewDoc);


                // myNewDoc.properties.customProperties.add("id", "val");


                return context.sync().then(function () {
                    //   var x = myNewDoc.properties.customProperties.getItem("id").value;
                    // var x = JSON.parse(myNewDoc.properties.comments);
                    myNewDoc.open();

                });
            })
.catch(function (error) {
    console.log('Error: ' + JSON.stringify(error));
    if (error instanceof OfficeExtension.Error) {
        console.log('Debug info: ' + JSON.stringify(error.debugInfo));
    }
});


        }


     



        //


    </script>
</head>
<body>
    Function file body is never displayed.



</body>
</html>
