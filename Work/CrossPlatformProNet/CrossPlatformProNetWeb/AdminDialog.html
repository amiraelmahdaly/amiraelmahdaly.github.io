<!DOCTYPE html>
<html>
<head>
    <title>Admin Panel</title>
    <meta charset="utf-8" />
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <style>
        .no-close .ui-dialog-titlebar-close {
            display: none;
        }

        .ui-dialog-titlebar {
            display: none;
        }

        .cleared{
            margin-top:10px;
            padding:10px;
            background-color:dodgerblue;
            color:white;
        }

        .ui-dialog-buttonpane{
            padding:0;
            margin:0;
            background-color:gainsboro;
            border:none;
        }

        .ui-dialog-content {
            font-size:12px;
        }
    </style>

</head>
<body class="container">

    <br />
    <div id="dialog"></div>

    <div id="dialogContainer">

        <button onclick="OpenConfirmationModalToken()" class="btn-block btn btn-default text-center">Clear Token</button>
        <button onclick="OpenConfirmationModalCache()" class="btn-block btn btn-default text-center">Clear Cache</button>

    </div>

    <script>

        Office.initialize = function () { };
        function ClearUserToken() {
            localStorage.removeItem("userToken");
            localStorage.setItem("accountName", "");
            Office.context.ui.messageParent(true);

        }

        function ClearCache() {
            // to be cleared
            Office.context.ui.messageParent(true);


        }

        $("#dialog").dialog({
            modal: true,
            autoOpen: false,
            dialogClass: "no-close",
            minWidth: 150,
            minHeight: 45
        });


        //$("#dialog").dialog({ autoOpen: false,minWidth : 150,minHeight : 90 });
        function OpenConfirmationModalToken() {
            $("#dialog").html("Clear user token? This will also clear cached data.");
            $("#dialog").dialog("option", "buttons",
  [
    {
        text: "Yes",
        click: function () {
            //ClearUserToken();
            $(this).dialog("close");
            $("#dialogContainer").html("<div class='cleared text-center'>Token successfully cleared</div>");
            setTimeout(function () { ClearUserToken(); }, 1500);
        },
        style: "margin:0 5px 0 0; padding:2px 7px;"

    },
    {
        text: "No",
        click: function () {
            $(this).dialog("close");
            $('#dialogContainer :button').blur();
        },
        style: "margin:0 5px 0 0; padding:2px 7px;"
    }
  ]
);
            $("#dialog").dialog("open");
            $('.ui-dialog :button').blur();

        }

        function OpenConfirmationModalCache() {
            $("#dialog").html("Clear cache?");
            $("#dialog").dialog("option", "buttons",
[
{
    text: "Yes",
    click: function () {
        $(this).dialog("close");
        $("#dialogContainer").html("<div class='cleared text-center'>Cache successfully cleared</div>");
        setTimeout(function () { ClearCache(); }, 1500);


    },
    style: "margin:0 5px 0 0; padding:2px 7px;"

},
{
    text: "No",
    click: function () {
        $(this).dialog("close");
        $('#dialogContainer :button').blur();
    },
    style: "margin:0 5px 0 0; padding:2px 7px;"
}
]
);
            $("#dialog").dialog("open");
            $('.ui-dialog :button').blur();
        }


    </script>
</body>
</html>
